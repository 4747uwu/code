version: '3.8'

services:
  figgy-backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: figgy-backend
    ports:
      - "5000:5000"
    environment:
      - NODE_ENV=production
      - PORT=5000
      - secretKey=secretKey
      - EMAIL=EMAIL
      - MongoDb_Connection_String=${MONGODB_CONNECTION_STRING}
    volumes:
      - ./backend/storage:/app/storage  # ✅ Make sure this volume mapping is correct
      - figgy-storage:/app/storage      # ✅ Or use a named volume
    restart: unless-stopped
    networks:
      - figgy-network

volumes:
  figgy-storage:  # ✅ Add named volume for persistent storage

networks:
  figgy-network:
    driver: bridge


